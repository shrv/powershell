В самом скрипте старался все максимально комментировать, поэтому в даваться в подробности не буду.

Скорее вкратце опишу как работает и ряд особенностей.

Особенность раз:

Поленился и не прикрутил диалоговые окна для указания файла с координатами деревни и для указания url сайта,

Поэтому скрипт перед запуском нужно подправлять вот в этом месте:

    $url = «http://ts1.travian.ru/&#187;
    $file = «C:\script\farm.xlsx»

в качестве переменной url указываем интересующий сервер,  в моем примере это первый, не забываем про закрывающий слеш. Руками прописываем путь к файлу с данными и его именем. можно этот файл обозвть так же как у меня в примере и поместить по тому же пути.

Особенность два:

Источником данных является excel файл. список не активных деревень в котором я взял с ресурса

http://www.gettertools.com

и просто скопировал в файл. Сам список может быть взят с любого ресурса, главное, что бы координаты деревень были в 1-ом столбце, как показано ниже на картинке.

primer

Особенность три:

После запуска скрипт «молчит» секунд 15-20, зависит от компьютера. В это время обрабатывается excel файл.

Особенность четыре:

Список, в который нужно внести деревни, необходимо создать заранее в игре.

Теперь о работе, как писал выше, после запуска обрабатывается файл, за тем уже появляются диалоговые окна.

В первом окне, необходимо указать логин и пароль для подключения к игре.

Во втором, выбрать из выпадающего списка название деревни, в список которой надо добавить.

В третьем, название самого списка в этой деревне.

Четвертое окно, спрашивает какие войска и сколько нужно добавить в этот список. Спрашивает один раз и применяет ко всему списку.

Как логическое завершение, скрипт начинает формировать запросы к серверу и вносить деревни из файла в список фарма.

По завершению работы, появится окно с сообщением.

На тестовом прогоне, при добавление 95 деревень, на все у меня ушло не более 3-х минут.

Теперь о том как запустить. Запустить из файла сразу не получится, для этого необходимо произвести ряд манипуляций, ну тут гугл вам в помощь «как запустить скрипт powershell из файла«.

Или, самое простое, открыть скрипт в том же блокноте, скопировать код скрипта, запустить powershell у себя на компьютере, вставить туда скрипт. Такой вариант сработает всегда.